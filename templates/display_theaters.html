<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Theatres in Your Area</title>
    <link rel= "stylesheet" type= "text/css" href= "../static/css/chart.css">
    <link rel= "stylesheet" type= "text/css" href= "../static/css/style.css">
      <link rel= "stylesheet" type= "text/css" href= "../static/css/movie_reel.css">
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.js"></script>
  </head>
  <body class="bodyDis">
        <div class="content">
          <div id = "map"></div>
          <div class="rightSide">
            <div class="titleWrapper">
              <p id="rightSideTitle">Don't Forget Your Popcorn</p>
            </div>
          {% for element in list %}

            <div class="theatreBox">
              <p><b></b>{{ element.name }} </p>
              <p id="address"><b>Address: </b>{{ element.address }} </p>
            </div>

            <form action="/fave-theaters" method="POST">
              <input id="disappear" type="hidden" name="nameInput" value="{{ element.name }}"></input>
              <input id="disappear" type="hidden" name="addressInput" value="{{ element.address }}"></input>
              <button type="submit" class="btn btn-default">Submit</button>
            </form>
            <div id="chartID"></div>
           {% endfor %}
         </div>
        </div>

  </body>
  <script>
            var locations = [];
            {% for element in list %}

            locations.push([ {{element.lat}}, {{element.lng}}, "{{ element.name}}" ]);
            // console.log({{element.name}});

            {% endfor %}
            function initMap(){
                var location = {lat:{{userLocationDict['latitude']}}, lng:{{userLocationDict['longitude']}}};

                var map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 12,
                    center: location,
                    styles: [
                        {elementType: 'geometry', stylers: [{color: '#242f3e'}]},
                        {elementType: 'labels.text.stroke', stylers: [{color: '#242f3e'}]},
                        {elementType: 'labels.text.fill', stylers: [{color: '#746855'}]},
                        {
                            featureType: 'administrative.locality',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#d59563'}]
                        },
                        {
                            featureType: 'poi',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#d59563'}]
                        },
                        {
                            featureType: 'poi.park',
                            elementType: 'geometry',
                            stylers: [{color: '#263c3f'}]
                        },
                        {
                            featureType: 'poi.park',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#6b9a76'}]
                        },
                        {
                            featureType: 'road',
                            elementType: 'geometry',
                            stylers: [{color: '#38414e'}]
                        },
                        {
                            featureType: 'road',
                            elementType: 'geometry.stroke',
                            stylers: [{color: '#212a37'}]
                        },
                        {
                            featureType: 'road',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#9ca5b3'}]
                        },
                        {
                            featureType: 'road.highway',
                            elementType: 'geometry',
                            stylers: [{color: '#746855'}]
                        },
                        {
                            featureType: 'road.highway',
                            elementType: 'geometry.stroke',
                            stylers: [{color: '#1f2835'}]
                        },
                        {
                            featureType: 'road.highway',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#f3d19c'}]
                        },
                        {
                            featureType: 'transit',
                            elementType: 'geometry',
                            stylers: [{color: '#2f3948'}]
                        },
                        {
                            featureType: 'transit.station',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#d59563'}]
                        },
                        {
                            featureType: 'water',
                            elementType: 'geometry',
                            stylers: [{color: '#17263c'}]
                        },
                        {
                            featureType: 'water',
                            elementType: 'labels.text.fill',
                            stylers: [{color: '#515c6d'}]
                        },
                        {
                            featureType: 'water',
                            elementType: 'labels.text.stroke',
                            stylers: [{color: '#17263c'}]
                        }
                    ]
                });


                var infowindow = new google.maps.InfoWindow();

                var marker, i;

                marker = new google.maps.Marker({
                    position: location,
                    icon: 'https://imgur.com/dOQ5uvh.png',
                    map: map

                });
                google.maps.event.addListener(marker, 'click', (function(marker) {
                    return function() {
                        infowindow.setContent("You are located here");
                        infowindow.open(map, marker);
                    }
                })(marker));

                for (i = 0; i < locations.length; i++) {

                    marker = new google.maps.Marker({
                        position: new google.maps.LatLng(locations[i][0], locations[i][1]),
                        icon: 'https://imgur.com/qUnGRR1.png',
                        map: map

                    });

                    google.maps.event.addListener(marker, 'click', (function(marker, i) {
                        return function() {
                            infowindow.setContent(locations[i][2] + "<br/><div style='float:left; margin-right: 8px; margin-top: 8px;'><img src='https://i.imgur.com/roENba2.png'></div><div style='float:left; margin-right: 8px; margin-top: 8px;'><img src='https://i.imgur.com/nPATIQP.png'></div><div style='float:left; margin-right: 8px; margin-top: 8px;'><img src='https://i.imgur.com/1GPIrkc.png'></div><div style='float:left; margin-right: 8px; margin-top: 8px;'><img src='https://i.imgur.com/CMpWVoA.png'></div>");
                            infowindow.open(map, marker);

                        }
                    })(marker, i));
                }

            }
       </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBABVNXk90RVdvQqgDanDifw-bgMGeONI&callback=initMap"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/jquery-3.3.1.min.js') }}"></script>
  <script type="text/javascript" src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</html>

